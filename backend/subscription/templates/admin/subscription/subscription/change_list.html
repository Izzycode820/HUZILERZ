{% extends "admin/change_list.html" %}
{% load i18n %}

{% block content %}
{# Dashboard Metrics Banner #}
{% if dashboard_metrics %}
<div style="
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    color: white;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
">
    <h2 style="margin: 0 0 15px 0; font-size: 18px; color: #fff;">
        üìä Subscription Dashboard
    </h2>
    
    {# Key Metrics Row #}
    <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 15px;">
        {# Active Subscriptions #}
        <div style="
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid #28a745;
            border-radius: 6px;
            padding: 12px 20px;
            min-width: 120px;
        ">
            <div style="font-size: 28px; font-weight: bold; color: #28a745;">
                {{ dashboard_metrics.total_active }}
            </div>
            <div style="font-size: 12px; color: #aaa;">Active</div>
        </div>
        
        {# Grace Period #}
        <div style="
            background: rgba(253, 126, 20, 0.2);
            border: 1px solid #fd7e14;
            border-radius: 6px;
            padding: 12px 20px;
            min-width: 120px;
        ">
            <div style="font-size: 28px; font-weight: bold; color: #fd7e14;">
                {{ dashboard_metrics.total_grace }}
            </div>
            <div style="font-size: 12px; color: #aaa;">Grace Period</div>
        </div>
        
        {# Pending Payment #}
        <div style="
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #ffc107;
            border-radius: 6px;
            padding: 12px 20px;
            min-width: 120px;
        ">
            <div style="font-size: 28px; font-weight: bold; color: #ffc107;">
                {{ dashboard_metrics.total_pending }}
            </div>
            <div style="font-size: 12px; color: #aaa;">Pending</div>
        </div>
        
        {# Expiring Soon (Urgent) #}
        <div style="
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid #dc3545;
            border-radius: 6px;
            padding: 12px 20px;
            min-width: 120px;
        ">
            <div style="font-size: 28px; font-weight: bold; color: #dc3545;">
                {{ dashboard_metrics.expiring_soon }}
            </div>
            <div style="font-size: 12px; color: #aaa;">‚ö†Ô∏è Expiring ‚â§5 days</div>
        </div>
        
        {# Revenue This Month #}
        <div style="
            background: rgba(111, 66, 193, 0.2);
            border: 1px solid #6f42c1;
            border-radius: 6px;
            padding: 12px 20px;
            min-width: 150px;
            margin-left: auto;
        ">
            <div style="font-size: 24px; font-weight: bold; color: #6f42c1;">
                {{ dashboard_metrics.revenue_this_month|floatformat:0 }} XAF
            </div>
            <div style="font-size: 12px; color: #aaa;">üí∞ Revenue This Month</div>
        </div>
    </div>
    
    {# Plan Distribution #}
    {% if dashboard_metrics.by_plan %}
    <div style="
        background: rgba(255,255,255,0.05);
        border-radius: 4px;
        padding: 10px 15px;
        font-size: 13px;
    ">
        <span style="color: #aaa;">Active by Plan:</span>
        {% for tier, count in dashboard_metrics.by_plan.items %}
            <span style="
                background: rgba(255,255,255,0.1);
                padding: 3px 8px;
                border-radius: 3px;
                margin-left: 10px;
            ">
                {{ tier|upper }}: <strong>{{ count }}</strong>
            </span>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endif %}

{{ block.super }}
{% endblock %}
